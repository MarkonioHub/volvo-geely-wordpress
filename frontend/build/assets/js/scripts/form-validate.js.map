{"version":3,"sources":["scripts/form-validate.js"],"names":["forms","document","querySelectorAll","i","length","formInit","form","phone","querySelector","name","addEventListener","removeError","validate","maskPhone","IMask","mask","maskName","classList","remove","e","preventDefault","unmaskedValue","add","fetchForm","success","console","log","closeModalForm","openThanks","value","url","getAttribute","data","FormData","append","fetch","method","body","then","res","json","alert","node","fancyboxContent","closest","closeBtn","click","thanks","Fancybox","show","src","type","modalThanksButton"],"mappings":"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","sourcesContent":["const forms = document.querySelectorAll('[data-role=\"form-validate\"]')\n\nfor (let i = 0; i < forms.length; i++) {\n    formInit(forms[i])\n}\n\nfunction formInit (form) {\n    const phone = form.querySelector('[data-role=\"form-input-phone\"]')\n    const name = form.querySelector('[data-role=\"form-input-name\"]')\n\n    phone.addEventListener('input', removeError)\n    form.addEventListener('submit', validate)\n\n    const maskPhone = new IMask(phone, { mask: '+{7} (000) 000-00-00' });\n    const maskName = new IMask(name, { mask: /^[А-ЯЁa-zA-Z\\s]+$/i });\n\n    function removeError () {\n        this.classList.remove('input-error')\n    }\n\n    function validate (e) {\n        e.preventDefault()\n        if (maskPhone.unmaskedValue.length < 11) {\n            phone.classList.add('input-error')\n        } else {\n            fetchForm()\n        }\n    }\n\n    async function fetchForm () {\n        const url = form.getAttribute('action')\n        const data = new FormData(form)\n        data.append(\"action\", \"callback_form\")\n        fetch(url, {\n            method: 'post',\n            body: data,\n        })\n            .then(res => { return res.json() })\n            .then(data => { success() })\n            .catch(() => {\n                alert('Похоже произошла ошибка, пожалуйста попробуйте позже')\n                console.log('error')\n            })\n\n        function success () {\n            console.log('success')\n            closeModalForm(form)\n            openThanks()\n            phone.value = ''\n            name.value = ''\n        }\n    }\n}\n\nfunction closeModalForm (node) {\n    const fancyboxContent = node.closest('.fancybox__content')\n    if (fancyboxContent) {\n        const closeBtn = fancyboxContent.querySelector('.is-close-btn')\n        closeBtn.click()\n    }\n}\n\nfunction openThanks () {\n    const thanks = document.querySelector('#modal-thanks')\n    if (thanks) Fancybox.show([{ src: \"#modal-thanks\", type: \"inline\" }])\n}\n\nconst modalThanksButton = document.querySelector('[data-element=\"modal-thanks-button\"]')\nmodalThanksButton.addEventListener('click', () => closeModalForm(modalThanksButton))\n"],"file":"form-validate.js"}